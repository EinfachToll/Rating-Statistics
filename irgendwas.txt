Rückgabe:
===========

Interpret, Bild, Wiedergabezähler, Liederanzahl, Albenanzahl, Bewertung, Punkte, Länge, Wichtung, Jahr

So hier muss man Interpreten gruppieren:
=======================================

SELECT
    (SELECT path from images i LEFT JOIN albums b ON (i.id = b.image) WHERE b.artist = c.artist AND path NOT LIKE 'amarok-sqltrackuid://%' ORDER BY RAND() LIMIT 1) as bild,
    a.name,
    wiedergabezaehler,
    anzlieder,
    c.anzalben,
    round(c.bewertung,1),
    round(c.punkte, 0),    
    laenge,
    wichtung,
    round(c.jahr, 0)
FROM (

SELECT 
    t.artist,
    count(distinct t.album) as anzalben,
    avg(if(s.rating < 1,  null, s.rating)) as bewertung,
    avg(s.score) as punkte,
    sum(s.playcount) as wiedergabezaehler,
    sum(t.length)    as laenge,
    count(if(s.rating < 1, null, s.rating)) as anzbew,
    count(*) as anzlieder,
    (5.0 * 3 * avg(if(s.rating < 1,  null, s.rating)))
    + (0.6 * 0 * avg(s.score))
    + (0.5 * 0 * sqrt(sum(t.length)/1000))
    + (2.5 * 0 * sum(s.playcount))
    as wichtung,
    avg(if(y.name < 1, null, y.name)) as jahr
FROM tracks t LEFT JOIN statistics s ON (s.url = t.url) LEFT JOIN years y on (t.year=y.id)

	--	LEFT JOIN genres g ON (t.genre=g.id)
WHERE true
	 --   AND upper(g.name) like upper('%Rock%')
	--  AND t.year   = y.id AND y.name = '2010'

    GROUP BY t.artist

	    HAVING anzbew >= 5 ORDER BY bewertung
	--  ORDER BY wiedergabezaehler
	--   ORDER BY anzlieder
	--   ORDER BY laenge
	--   HAVING count(if( s.score  is null, null, s.score)) >= 5 ORDER BY punkte
	--   HAVING anzbew >= 5 ORDER BY wichtung
	--   ORDER BY anzalben
	--   HAVING anzlieder >= ORDER BY jahr
DESC LIMIT 10
) c JOIN artists a on (c.artist = a.id)




Lieder:
========

select 
concat (t.title, ' von ', artists.name, ' auf ', albums.name),
images.path,
s.playcount as wiedergabezaehler,
-1,
-1,
s.rating as bewertung,
s.score,
t.length as laenge,
3 as wichtung,
years.name as jahr
from tracks t, images, statistics s, years, artists, albums where t.url=s.url AND t.album=albums.id AND albums.image=images.id AND t.year=years.id AND t.artist=artists.id
AND upper(artists.name) like upper('%Nightwish%')
Order by s.score 


Alben:
=======

So geht das mit dem Rang, wenn man ein bestimmtes Dingens sucht:
================================================================

set @zei := 0;
set @derrang := (select ra from (select @zei:=@zei+1 as ra, title from tracks order by length) as kl where title = 'Ants')
set @zei := 0;
select * from
	(select @zei := @zei + 1 as rang, title, length from tracks order by length) as erg
where rang between
	@derrang -5 and @derrang + 5;
